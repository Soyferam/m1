/* Bottom sheet for settings */
.sheet-overlay { 
    position: fixed; 
    inset: 0; 
    background: rgba(0,0,0,0.6); 
    backdrop-filter: blur(4px); 
    -webkit-backdrop-filter: blur(4px); 
    z-index: 1100; 
    display: none; /* По умолчанию скрыто */
}

.sheet-overlay[style*="display: block"] {
    display: flex !important; /* Принудительно показываем при display: block */
}

/* Дополнительные стили для модального окна настроек */
#settings-modal {
    z-index: 1200 !important; /* Высокий z-index */
}

#settings-modal .sheet-content {
    z-index: 1201 !important; /* Еще выше для контента */
    position: absolute !important; /* Абсолютное позиционирование для bottom sheet */
    bottom: 0 !important; /* Прижимаем к низу экрана */
    left: 0 !important;
    right: 0 !important;
    display: block !important; /* Принудительно показываем контент */
}

/* Убеждаемся, что модальное окно видимо */
#settings-modal[style*="display: block"] {
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
}

/* Принудительно показываем контент при открытом модальном окне */
#settings-modal[style*="display: block"] .sheet-content {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    transform: none !important; /* Убираем transform */
}

/* Переопределяем конфликтующие стили */
#settings-modal[style*="display: block"] {
    opacity: 1 !important;
    backdrop-filter: blur(4px) !important;
    -webkit-backdrop-filter: blur(4px) !important;
}

#settings-modal[style*="display: block"] .sheet-content {
    transform: translateY(0) !important;
}

.sheet-content { 
    position: absolute; 
    left: 0; 
    right: 0; 
    bottom: 0; 
    background: #0e0f12; 
    color: #fff; 
    border-top-left-radius: 20px; 
    border-top-right-radius: 20px; 
    border: 1px solid rgba(255,255,255,0.08); 
    padding: 12px 16px 20px; 
    max-height: 80vh; 
    overflow: auto; 
}
.sheet-grabber { 
    width: 48px; 
    height: 5px; 
    border-radius: 3px; 
    background: rgba(255,255,255,0.3); 
    margin: 6px auto 10px; 
}
.sheet-title { 
    text-align: center; 
    font-weight: 800; 
    margin-bottom: 12px; 
}
.sheet-header { 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    margin-bottom: 8px; 
}
.sheet-header .sheet-title { 
    margin: 0; 
    text-align: center; 
}
.sheet-header-spacer { 
    display: none; 
}
.settings-section { 
    margin: 10px 0 16px; 
}
.settings-label { 
    font-weight: 700; 
    margin-bottom: 8px; 
    font-size: 16px; 
}
.lang-row { 
    display: grid; 
    grid-template-columns: repeat(3, 1fr); 
    gap: 10px; 
}
.lang-option { 
    display: inline-flex; 
    align-items: center; 
    justify-content: center; 
    gap: 8px; 
    padding: 12px; 
    border-radius: 14px; 
    border: 1px solid rgba(255,255,255,0.15); 
    background: rgba(255,255,255,0.08); 
    color: #fff; 
    font-weight: 800; 
    font-size: 15px; 
}
.lang-option img { 
    width: 20px; 
    height: 20px; 
    border-radius: 4px; 
    object-fit: cover; 
}
.lang-option:active { 
    transform: scale(0.98); 
}
.lang-option.active {
    background: rgba(19, 67, 222, 0.3);
    border-color: #1343DE;
    color: #fff;
    box-shadow: 0 0 20px rgba(19, 67, 222, 0.3);
}
.support-btn { 
    width: 100%; 
    display: inline-flex; 
    align-items: center; 
    justify-content: center; 
    gap: 10px; 
    padding: 12px; 
    border-radius: 14px; 
    border: 1.5px solid rgba(255,255,255,0.2); 
    background: rgba(0,123,255,0.9); 
    color: #fff; 
    font-weight: 800; 
}
.support-btn img { 
    width: 20px; 
    height: 20px; 
    object-fit: contain; 
    filter: brightness(0) invert(1); 
}
.lb-cup { 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    margin: 8px 0 12px 0; 
}
.lb-cup .lottie { 
    width: 120px; 
    aspect-ratio: 1/1; 
}
/* Font Face Declaration */
@font-face {
    font-family: 'Onest';
    src: url('./fonts/Onest-VariableFont_wght.ttf') format('truetype');
    font-weight: 100 900;
    font-style: normal;
    font-display: swap;
}

/* CSS Variables for easy customization */
:root {
    --background-start: #0f0f23;
    --background-middle: #1a1a2e;
    --background-end: #16213e;
    --primary-color: #00d4ff;
    --secondary-color: #0099cc;
    --accent-color: #4caf50;
    --warning-color: #ff9800;
    --danger-color: #f44336;
    --bottom-nav-height: 72px;
    --font-family: 'Onest', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

/* Reset and base styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    /* Единый фон для всех страниц */
    background: #1A1A1F !important;
    background-color: #1A1A1F !important;
    min-height: 100%;
    overscroll-behavior-y: none;
    scrollbar-width: none; /* Firefox */
}

html::-webkit-scrollbar { display: none; }

body {
    font-family: var(--font-family);
    color: white;
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    min-height: 100vh;
    scrollbar-width: none;
    -ms-overflow-style: none;
    background: #1A1A1F !important;
    background-color: #1A1A1F !important;
    overscroll-behavior-y: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-touch-callout: none; /* отключить меню "копировать" на iOS */
    -webkit-tap-highlight-color: rgba(0,0,0,0); /* убрать подсветку тапов */
}

body::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
}

/* Telegram Web App specific styles */
.app-container {
    min-height: 100vh;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    display: flex;
    flex-direction: column;
    gap: 20px;
    overflow: visible;
}

/* Разрешаем выделение текста только в интерактивных полях */
input, textarea {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
}

/* Liquid Glass Effect */
.liquid-glass {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

/* Top Bar */
.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px calc(env(safe-area-inset-right) + 6px) 14px calc(env(safe-area-inset-left) + 6px); /* ближе к краям с учётом safe area */
    margin-top: calc(env(safe-area-inset-top) + 56px); /* заметно ниже */
    z-index: 1000;
}

.top-left-actions { display: flex; align-items: center; gap: 8px; }

.help-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.settings-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.settings-btn:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.05); }
.settings-btn img { width: 22px; height: 22px; filter: brightness(0) invert(1); object-fit: contain; flex-shrink: 0; }

.help-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
}

.help-btn img {
    width: 26px;
    height: 26px;
    filter: brightness(0) invert(1);
    object-fit: contain;
    flex-shrink: 0;
}

.currency-display {
    display: flex;
    align-items: center;
    gap: 6px;                                      /* было 8px */
    background: rgba(0, 123, 255, 0.2);
    padding: 6px 12px;                             /* было 8px 16px */
    border-radius: 22px;                           /* чуть меньше */
    border: 1px solid rgba(0, 123, 255, 0.3);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    margin-top: 6px; /* опустить чуть ниже */
}

.currency-amount {
    font-weight: 600;
    font-size: 15px;
}

.currency-icon {
    width: 18px;
    height: 18px;
    object-fit: contain;
    flex-shrink: 0;
}

.add-currency-btn {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: rgba(0, 123, 255, 0.8);
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0; /* убираем внутренние отступы */
}

.plus-icon {
    width: 12px;
    height: 12px;
    object-fit: contain;
    filter: brightness(0) invert(1); /* делаем иконку белой */
}

.add-currency-btn:hover {
    background: rgba(0, 123, 255, 1);
    transform: scale(1.1);
}

/* Game Header */
.game-header {
    text-align: center;
    padding: 20px 20px 8px 20px; /* меньше нижний паддинг */
}

.game-logo {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 12px; /* было 20px */
}

.game-logo-image {
    width: auto;
    height: 60px;
    max-width: 300px;
    object-fit: contain;
    flex-shrink: 0;
}

.connection-status {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 20px;
    border-radius: 20px;
    border: 1px solid rgba(76, 175, 80, 0.3);
    font-size: 12px;
    margin: 6px auto 8px auto; /* небольшие отступы сверху/снизу */
}

.status-dot {
    width: 8px;
    height: 8px;
    background: var(--accent-color);
    border-radius: 50%;
    animation: pulse 2s infinite;
    flex-shrink: 0;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

/* Character Section */
.character-section {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px 20px 10px 20px;
    position: relative;
}

.nav-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
}

.nav-left {
    left: 10px;
}

.nav-right {
    right: 10px;
}

.nav-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-50%) scale(1.05);
}

.nav-btn img {
    width: 20px;
    height: 20px;
    filter: brightness(0) invert(1);
    object-fit: contain;
    flex-shrink: 0;
}

.character-container {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
}

.character {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

.snake-canvas {
    width: calc(100vw - 140px);
    height: 200px;
    max-width: 400px;
    min-width: 360px;
    border-radius: 15px;
    background: transparent;
    margin: 0 auto;
    display: block;
    /* Создаем маску для обрезки свечения */
    overflow: hidden;
    position: relative;
}

.edit-btn {
    position: absolute;
    top: -10px;
    right: -10px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.edit-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

.edit-btn img {
    width: 16px;
    height: 16px;
    filter: brightness(0) invert(1);
    object-fit: contain;
    flex-shrink: 0;
}

/* Multiplier Buttons */
.multiplier-buttons {
    display: flex;
    justify-content: center;
    gap: 8px;
    padding: 10px 20px 15px 20px;
}

.multiplier-btn {
    padding: 10px 16px;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.multiplier-btn.active,
.multiplier-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.4);
    transform: scale(1.05);
}

.multiplier-btn.pulse-animation {
    animation: buttonPulse 0.3s ease;
}

@keyframes buttonPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1.05); }
}

/* Custom Multiplier Modal */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.modal-content {
    background: rgba(18, 20, 25, 0.65); /* темнее для контраста на мобильных */
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 1.5px solid rgba(255, 255, 255, 0.15);
    border-radius: 25px;
    padding: 30px;
    width: 90%;
    max-width: 380px;
    color: white;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.modal-header h3 {
    font-size: 20px;
    font-weight: 600;
    margin: 0;
}

.modal-close {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background 0.3s ease;
}

.modal-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

.input-section {
    margin-bottom: 20px;
}

.custom-input {
    width: 100%;
    padding: 18px;
    border: 1.5px solid rgba(255, 255, 255, 0.22);
    border-radius: 15px;
    background: rgba(0, 0, 0, 0.35); /* темнее для читаемости */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: #ffffff;
    font-size: 20px;
    text-align: center;
    font-weight: 700;
    font-family: var(--font-family);
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
}

.custom-input::placeholder {
    color: rgba(255, 255, 255, 0.5);
}

.custom-keyboard {
    margin-bottom: 20px;
}

.keyboard-row {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    justify-content: stretch;
}

.key-btn {
    flex: 1;
    height: 55px;
    border: 1px solid rgba(255, 255, 255, 0.25);
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.35); /* темные кнопки для лучшей читаемости цифр */
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: #ffffff;
    font-size: 20px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
    font-family: var(--font-family);
    text-shadow: 0 1px 2px rgba(0,0,0,0.55);
}

.key-btn:hover {
    background: rgba(0, 0, 0, 0.45);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.25);
}

.key-btn:active {
    transform: translateY(0);
    background: rgba(0, 0, 0, 0.55);
}

.delete-btn {
    background: rgba(255, 80, 80, 0.15);
}

.delete-btn:hover {
    background: rgba(255, 80, 80, 0.25);
}

.modal-buttons {
    display: flex;
    gap: 10px;
}

.modal-play-btn {
    flex: 1;
    padding: 12px;
    border-radius: 15px;
    border: none;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-family: var(--font-family);
}

.modal-play-star {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.8), rgba(255, 152, 0, 0.8));
    color: white;
    border: 1px solid rgba(255, 193, 7, 0.3);
}

.modal-play-ton {
    background: linear-gradient(135deg, rgba(0, 123, 255, 0.8), rgba(0, 86, 179, 0.8));
    color: white;
    border: 1px solid rgba(0, 123, 255, 0.3);
}

.modal-play-btn:hover {
    transform: scale(1.05);
}

.modal-play-btn .play-icon {
    width: 16px;
    height: 16px;
}

/* Play Buttons */
.play-buttons {
    display: flex;
    gap: 15px;
    padding: 10px 20px 15px 20px;
    justify-content: center;
    flex-direction: row;
}

.play-btn {
    padding: 15px 30px;
    border-radius: 25px;
    border: none;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    flex: 1;
    max-width: 200px;
    text-align: center;
}

.play-ton {
    background: linear-gradient(135deg, rgba(0, 123, 255, 0.8), rgba(0, 86, 179, 0.8));
    color: white;
    border: 1px solid rgba(0, 123, 255, 0.3);
}

.play-star {
    background: linear-gradient(135deg, rgba(255, 193, 7, 0.8), rgba(255, 152, 0, 0.8));
    color: white;
    border: 1px solid rgba(255, 193, 7, 0.3);
}

.play-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
}

.play-icon {
    width: 20px;
    height: 20px;
    object-fit: contain;
    flex-shrink: 0;
}

/* Main Content Area - Fixed */
.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 10px;
    overflow: visible;
}

/* Shop Section - Natural part of page */
.shop-section {
    margin: 5px 0 0 0;
    padding: 25px;
    overflow: visible;
    display: flex;
    flex-direction: column;
}

/* Shop container visuals */
.shop-section {
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    border: 1.5px solid rgba(255, 255, 255, 0.8); /* было 2px */
    border-radius: 20px;
    padding: 0 20px 20px 20px;
    margin-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 16px); /* безопасный зазор под рамкой */
}

/* Shop header and filters - fixed */
/* Убираем скроллбар для элементов магазина так как теперь прокручивается вся страница */

.filter-btn {
    padding: 10px 16px;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.12);
    border: 1.5px solid rgba(255, 255, 255, 0.28);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    color: #fff;
    font-weight: 600;
}
.filter-btn.active {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.4);
}

.filter-btn.active {
    background: #ffffff;
    color: #111418;
    border-color: rgba(255, 255, 255, 0.9);
}

.shop-item {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 15px;
    padding: 12px 8px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
    min-height: 110px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
}

.shop-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.shop-item.hidden { display: none; }

.item-image {
    width: 60px;
    height: 60px;
    margin-bottom: 10px;
    object-fit: contain;
    flex-shrink: 0;
}

.item-name {
    font-size: 12px;
    font-weight: 500;
    line-height: 1.3;
    text-align: center;
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
}

/* Item price under name */
/* Баланс - сохраним стиль кнопки */
.item-price {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-top: 8px;
    font-size: 13px;
    font-weight: 700;
    background: rgba(255, 193, 7, 0.2);
    padding: 6px 10px;
    border-radius: 14px;
    border: 1.5px solid rgba(255, 193, 7, 0.3);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}
.price-icon {
    width: 16px;
    height: 16px;
    object-fit: contain;
}

/* Bottom Navigation */
.bottom-nav {
    display: flex;
    justify-content: space-around;
    align-items: center;
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 10px;
    position: fixed;
    left: 16px;
    right: 16px;
    bottom: calc(env(safe-area-inset-bottom) + 20px);
    border-radius: 16px; /* Полное закругление */
    z-index: 1000;
}

.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    padding: 8px;
    border-radius: 10px;
}

.nav-item img {
    width: 24px;
    height: 24px;
    filter: brightness(0) invert(1);
    opacity: 0.7;
    transition: all 0.3s ease;
    object-fit: contain;
    flex-shrink: 0;
}

.nav-item.active img,
.nav-item:hover img {
    opacity: 1;
    transform: scale(1.1);
}

.nav-item.active {
    background: rgba(255, 255, 255, 0.1);
}

.nav-item.disabled {
    opacity: 1; /* сама кнопка кликабельна, внешний вид меняем только иконкой */
}

.nav-item.disabled img {
    filter: grayscale(1) opacity(0.6); /* делаем иконку "неактивной" по цвету */
}

/* Bottom nav active/inactive states (унифицировано) */
.bottom-nav .nav-item {
	background: none;
	transition: transform 0.12s ease;
}

/* База: делаем все иконки белыми, но приглушенными */
.bottom-nav .nav-item img {
	filter: brightness(0) invert(1) grayscale(1) !important;
	opacity: 0.55 !important;
	transition: filter 0.2s ease, opacity 0.2s ease, transform 0.12s ease;
}

/* Активная: белая иконка, без приглушения */
.bottom-nav .nav-item.active img {
	filter: brightness(0) invert(1) grayscale(0) !important;
	opacity: 1 !important;
}

/* Bottom nav icons via CSS mask (SVG) */
.bottom-nav .nav-item .icon {
	width: 26px;
	height: 26px;
	display: block;
	background-color: rgba(255, 255, 255, 0.55); /* неактивные — серые */
	transition: background-color 0.2s ease, transform 0.12s ease;
}

.bottom-nav .nav-item.active .icon {
	background-color: #ffffff; /* активная — белая */
}

/* Маски для конкретных иконок */
.icon-stats {
	-webkit-mask: url('assets/stats-icon.svg') no-repeat center / contain;
	mask: url('assets/stats-icon.svg') no-repeat center / contain;
}
.icon-friends {
	-webkit-mask: url('assets/friends-icon.svg') no-repeat center / contain;
	mask: url('assets/friends-icon.svg') no-repeat center / contain;
}
.icon-home {
	-webkit-mask: url('assets/home-icon.svg') no-repeat center / contain;
	mask: url('assets/home-icon.svg') no-repeat center / contain;
}
.icon-rewards {
	/* используем PNG-иконку (белая), без маски */
	background-color: transparent !important;
	background-image: url('assets/snake-coin-icon.png');
	background-repeat: no-repeat;
	background-position: center;
	background-size: contain;
	opacity: 0.55; /* базовое приглушение как у остальных */
}
.bottom-nav .nav-item.active .icon.icon-rewards {
	opacity: 1;
}
.icon-withdraw {
	-webkit-mask: url('assets/wallet-icon.svg') no-repeat center / contain;
	mask: url('assets/wallet-icon.svg') no-repeat center / contain;
}

/* Responsive Design */
@media (max-width: 480px) {
    .app-container {
        gap: 15px;
    }
    
    .top-bar {
        padding: 15px;
    }
    
    .nav-left {
        left: 5px;
    }
    
    .nav-right {
        right: 5px;
    }
    
    .modal-content {
        width: 95%;
        max-width: none;
        padding: 25px;
    }
    
    .key-btn {
        height: 50px;
        font-size: 18px;
    }
    
    .keyboard-row {
        gap: 8px;
    }
    
    .custom-input {
        font-size: 18px;
        padding: 15px;
    }
    
    .modal-header h3 {
        font-size: 18px;
    }
    
    .game-logo-image {
        height: 50px;
        max-width: 250px;
    }
    
    .snake-character {
        width: 100px;
        height: 100px;
    }
    
    .snake-canvas {
        width: calc(100vw - 100px);
        height: 170px;
        max-width: 360px;
        min-width: 320px;
    }
    
    .play-buttons {
        flex-direction: row;
        gap: 10px;
    }
    
    .play-btn {
        flex: 1;
        max-width: none;
        padding: 12px 20px;
        font-size: 14px;
        justify-content: center;
        text-align: center;
    }
}

@media (max-width: 360px) {
    .multiplier-buttons {
        gap: 5px;
    }
    
    .multiplier-btn {
        padding: 6px 12px;
        font-size: 14px;
    }
    
    .shop-section {
        padding: 20px 20px 0 20px;
    }
    
    .play-buttons {
        gap: 8px;
    }
    
    .play-btn {
        padding: 10px 16px;
        font-size: 13px;
        justify-content: center;
        text-align: center;
    }
}

/* Safe area support for different devices */
@supports (padding: max(0px)) {
    .app-container {
        padding-top: max(20px, env(safe-area-inset-top));
        padding-bottom: max(20px, env(safe-area-inset-bottom));
        padding-left: max(20px, env(safe-area-inset-left));
        padding-right: max(20px, env(safe-area-inset-right));
    }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
    body {
        background: linear-gradient(135deg, var(--background-start) 0%, var(--background-middle) 50%, var(--background-end) 100%);
    }
}

/* High contrast mode */
@media (prefers-contrast: high) {
    .liquid-glass {
        border-width: 2px;
        border-color: rgba(255, 255, 255, 0.5);
    }
    
    .nav-item.active {
        background: rgba(255, 255, 255, 0.3);
    }
    
    .play-btn {
        border-width: 2px;
    }
}

/* Shop v2: unified head + scrollable content */
.shop-head {
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    padding-top: 16px; /* чтобы баланс не прилипал к обводке */
}

.shop-head-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
}

.shop-head h2 {
    font-size: 26px;
    font-weight: 800;
}

/* Shop currency with larger icon */
/* Баланс - сохраним стиль кнопки */
.shop-currency {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 193, 7, 0.2);
    padding: 8px 16px;
    border-radius: 20px;
    border: 1.5px solid rgba(255, 193, 7, 0.3);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.shop-currency span {
    font-size: 16px;
    font-weight: 600;
}

.coin-icon {
    width: 24px;
    height: 24px;
    object-fit: contain;
    flex-shrink: 0;
}

/* Filters under title, not centered */
.shop-filters {
    display: flex;
    gap: 10px;
    justify-content: flex-start;
}

/* Убираем отдельную прокрутку - весь контент листается через общую страницу */
.shop-content {
    /* max-height: min(42vh, 420px); */ /* Убираем ограничение высоты */
    /* overflow-y: auto; */ /* Убираем отдельную прокрутку */
    /* overflow-x: hidden; */
    margin: 0 -25px;
    padding: 12px 25px 12px 25px; /* Отступ снизу для навигации */
    background: transparent;
}

/* Убираем стили скроллбара так как отдельной прокрутки больше нет */

/* Grid of items 2 per row */
.shop-items {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    /* Убираем отдельную прокрутку магазина */
    max-height: none;
    overflow: visible;
    padding: 0; /* было 0 0 60px 0 — убрали пустоту снизу */
    margin: 0;
}

/* Убираем лишний нижний паддинг внутри контента магазина,
   чтобы рамка шла сразу после последних карточек */
.shop-content {
    /* max-height: min(42vh, 420px); */
    /* overflow-y: auto; */
    /* overflow-x: hidden; */
    margin: 0 -25px;
    padding: 12px 25px 12px 25px; /* было calc(... + 50px) — сделали компактным */
}

@media (max-width: 480px) {
    .shop-content {
        /* max-height: 260px; */ /* Убираем ограничение высоты и на мобильных */
        margin: 0 -20px;
        padding: 12px 20px 12px 20px; /* мобильная версия тоже без большой пустоты снизу */
    }
    
    .shop-items {
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }
}

/* SPA views visibility control */
.view { display: none; }
.view.visible { display: block; }
.view[aria-hidden="true"] { display: none !important; }
.view[aria-hidden="false"] { display: block !important; }

/* Безопасная зона под фиксированным нижним навбаром */
.content-safe {
	padding-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 24px);
}

/* Критические CTA: гарантируем зазор над навбаром и корректный скролл */
.critical-cta {
	margin-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 12px);
	scroll-margin-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 20px);
}

/* Кнопка-цена тоже как CTA по скроллингу */
.item-price {
	scroll-margin-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 20px);
}

/* 3D Coin */
.coin-wrapper {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 12px 0 8px 0;
}

.coin-stage {
    width: 150px;
    height: 150px; /* как у .lb-cup .lottie */
    border-radius: 20px;
    background: transparent; /* прозрачный фон, рендерер с alpha */
    position: relative;
    touch-action: none; /* исключаем скролл страницы при вращении монетки */
    -ms-touch-action: none;
}

/* Model viewer specific styles */
.coin-stage model-viewer {
    width: 100%;
    height: 100%;
    border-radius: 20px;
    --poster-color: transparent;
    --progress-bar-color: transparent;
    --progress-mask: transparent;
    /* Убираем полоску загрузки */
    --progress-bar-height: 0px;
    --progress-bar-width: 0px;
    --progress-bar-opacity: 0;
    --progress-bar-visibility: hidden;
}

/* Убираем стили для fallback изображений */
.coin-stage img.coin-fallback {
    display: none !important;
}

/* Скрываем стандартные элементы загрузки model-viewer */
.coin-stage model-viewer::part(progress-bar),
.coin-stage model-viewer::part(progress-mask),
.coin-stage model-viewer::part(poster) {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    height: 0 !important;
    width: 0 !important;
}

/* Дополнительно скрываем через CSS переменные */
.coin-stage model-viewer {
    --progress-bar-height: 0px !important;
    --progress-bar-width: 0px !important;
    --progress-bar-opacity: 0 !important;
    --progress-bar-visibility: hidden !important;
}

/* Максимально скрываем все элементы загрузки */
.coin-stage model-viewer [slot="progress-bar"],
.coin-stage model-viewer [slot="progress-mask"],
.coin-stage model-viewer [slot="poster"] {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    height: 0 !important;
    width: 0 !important;
    position: absolute !important;
    left: -9999px !important;
    top: -9999px !important;
}

/* Скрываем через CSS части с максимальным приоритетом */
.coin-stage model-viewer::part(progress-bar),
.coin-stage model-viewer::part(progress-mask),
.coin-stage model-viewer::part(poster) {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    height: 0 !important;
    width: 0 !important;
    position: absolute !important;
    left: -9999px !important;
    top: -9999px !important;
}

/* Rewards view positioning for coin under top bar */
#view-rewards {
    display: flex;
    flex-direction: column;         /* колонка */
    align-items: center;            /* центр по горизонтали */
    justify-content: flex-start;    /* к началу по вертикали */
    min-height: calc(100vh - var(--bottom-nav-height) - env(safe-area-inset-bottom));
    padding-top: calc(env(safe-area-inset-top) + 4px); /* минимальный отступ сверху */
}

#view-rewards .coin-wrapper {
    width: 100%;
    height: auto;
    margin-top: 4px;                /* чуть ниже баланса/хелпа */
    display: flex;
    align-items: center;
    justify-content: center;
}

#view-rewards .coin-stage {
    margin: 0 auto;
    display: grid;
    place-items: center;
}

#view-rewards .coin-stage > canvas,
#view-rewards .coin-stage > model-viewer {
    max-width: 100%;
    max-height: 100%;
    width: 100% !important;
    height: 100% !important;
    object-fit: contain;
}

/* Rewards (tasks) section — похож на магазин */
.rewards-section {
    background: transparent;
    border: 1.5px solid rgba(255, 255, 255, 0.8);
    border-radius: 20px;
    padding: 0 20px 20px 20px;
    margin: 12px 0;
    margin-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 16px); /* безопасный зазор под рамкой */
}

.rewards-head {
    background: transparent;
    padding-top: 16px;
}
.rewards-head-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
}
.rewards-head h2 {
    font-size: 24px;
    font-weight: 800;
}
.rewards-currency {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 193, 7, 0.2);
    padding: 8px 16px;
    border-radius: 20px;
    border: 1.5px solid rgba(255, 193, 7, 0.3);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}
.rewards-currency span {
    font-size: 16px;   /* как в магазине */
    font-weight: 600;  /* как в магазине */
}

.rewards-content { padding: 0; margin: 0; }
.rewards-list { display: flex; flex-direction: column; gap: 10px; }

.reward-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    background: rgba(255, 255, 255, 0.06);
    border: 1.5px solid rgba(255, 255, 255, 0.15);
    border-radius: 14px;
    padding: 12px;
    text-decoration: none;
    color: inherit;
}
.reward-info { display: flex; flex-direction: column; gap: 4px; }
.reward-title { font-size: 14px; font-weight: 700; }
.reward-desc { font-size: 12px; opacity: 0.8; }

.reward-prize { display: inline-flex; align-items: center; gap: 6px; margin-top: 6px; opacity: 0.95; }
.reward-prize span { font-size: 12px; opacity: 0.85; }
.reward-prize strong { font-size: 14px; font-weight: 800; }
.reward-prize .price-icon { width: 16px; height: 16px; object-fit: contain; }

.reward-check {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 12px;
    border-radius: 12px;
    border: 1.5px solid rgba(255, 255, 255, 0.22);
    background: rgba(255, 255, 255, 0.12);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color: #fff;
    font-weight: 700;
    font-size: 12px;
}
.reward-check:hover { transform: translateY(-1px); background: rgba(255, 255, 255, 0.18); }
.reward-check:active { transform: translateY(0); }

/* Leaderboard section */
.leaderboard-section {
    background: transparent;
    border: 1.5px solid rgba(255, 255, 255, 0.8);
    border-radius: 20px;
    padding: 0 20px 20px 20px;
    margin: 12px 0;
    /* Переносим пространство под липкую карточку НАРУЖУ границы, чтобы контур кончался после последнего игрока */
    margin-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 120px);
}
.leaderboard-head { background: transparent; padding-top: 16px; }
.leaderboard-head-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}
.leaderboard-head h2 { font-size: 24px; font-weight: 800; }
.leaderboard-currency { display: none !important; }
.leaderboard-currency span { font-size: 14px; font-weight: 600; }
.lb-header-row {
    display: grid; grid-template-columns: 1fr 0.7fr 0.7fr 0.5fr; gap: 10px;
    padding: 6px 8px;
    border: none;               /* убрать рамку */
    background: transparent;    /* убрать фон/blur */
    font-weight: 700; font-size: 12px;
    font-variant-numeric: tabular-nums; /* ровные цифры */
}
.lb-header-row span:nth-child(2),
.lb-header-row span:nth-child(3),
.lb-header-row span:nth-child(4) {
    text-align: right;
}
.leaderboard-content { margin-top: 10px; position: relative; }
.lb-list { display: flex; flex-direction: column; gap: 8px; padding-bottom: 72px; }
.lb-item {
    display: grid; grid-template-columns: 1fr 0.7fr 0.7fr 0.5fr; gap: 10px;
    align-items: center; padding: 10px; border-radius: 12px;
    background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
    font-size: 13px;
}
.lb-item span { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; font-variant-numeric: tabular-nums; }
.lb-item span:nth-child(2),
.lb-item span:nth-child(3),
.lb-item span:nth-child(4) {
    text-align: right;
}
.lb-item span:nth-child(2), /* токены */
.lb-item span:nth-child(3)  /* профит */ { color: #4caf50; font-weight: 700; }
.lb-you { background: rgba(0, 123, 255, 0.15); border-color: rgba(0, 123, 255, 0.35); font-weight: 700; }
.sticky-you { position: sticky; bottom: 0; }

/* Leaderboard personal stats */
.lb-stats {
    background: transparent;
    border: 1.5px solid rgba(255, 255, 255, 0.8);
    border-radius: 20px;
    padding: 14px 16px;
    margin: 12px 0;
}
.lb-stats-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.lb-stats h2 { font-size: 20px; font-weight: 800; }
.lb-share-btn { padding: 8px 12px; border-radius: 14px; border: 1.5px solid rgba(0,123,255,0.35); background: rgba(0,123,255,0.18); color: #fff; font-weight: 700; }
.lb-stats-row {
    display: grid; grid-template-columns: auto 1fr 1fr; gap: 10px;
}
.lb-avatar {
    width: 48px; height: 48px; border-radius: 50%;
    border: 1.5px solid rgba(255,255,255,0.3);
    overflow: hidden; display: flex; align-items: center; justify-content: center;
    background: rgba(255,255,255,0.06);
}
.lb-avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
.lb-stat { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 10px; }
.lb-stat .label { display: block; font-size: 11px; opacity: 0.8; margin-bottom: 4px; }
.lb-stat .value { font-size: 16px; font-weight: 700; }

/* Referrals section */
.referrals-section {
    background: transparent;
    border: 1.5px solid rgba(255, 255, 255, 0.8);
    border-radius: 20px;
    padding: 16px 20px 20px 20px;
    margin: 12px 0;
    margin-bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 16px);
}
.ref-cup { display:flex; justify-content:center; align-items:center; margin: 6px 0 10px 0; }
.ref-cup .lottie { width: 110px; aspect-ratio: 1/1; }
.referrals-head h2 { font-size: 18px; font-weight: 700; margin-bottom: 10px; text-align: center; }
.ref-generate-btn {
    display: inline-flex; align-items: center; justify-content: center;
    padding: 10px 16px; border-radius: 18px; border: 1.5px solid rgba(0,123,255,0.35);
    background: rgba(0,123,255,0.18); color: #fff; font-weight: 700; margin: 0 auto; display: block;
}
.ref-link { margin-top: 8px; text-align: center; font-size: 12px; opacity: 0.9; }
.referrals-content { margin-top: 14px; }
.ref-total { display:flex; justify-content: space-between; align-items:center; padding: 8px 10px; border-radius:12px; background: transparent; border: none; margin-bottom: 8px; }
.ref-total-head { font-weight: 800; opacity: 0.9; }
.ref-total-sum { font-weight: 800; color: #4caf50; }
.ref-header-row { display: grid; grid-template-columns: 1fr 0.8fr; gap: 10px; padding: 8px 10px; border-radius: 12px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); font-weight: 700; font-size: 12px; }
.ref-header-row.plain { background: transparent; border: none; }
.ref-header-row span:nth-child(2) { text-align: right; }
.ref-list { display: flex; flex-direction: column; gap: 8px; margin-top: 8px; }
.ref-item { display: grid; grid-template-columns: 1fr 0.8fr; gap: 10px; align-items: center; padding: 10px; border-radius: 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); font-size: 13px; }
.ref-item span:nth-child(2) { color: #4caf50; font-weight: 700; text-align: right; }
/* Чёткое выравнивание чисел по сетке */
.ref-header-row span, .ref-item span { font-variant-numeric: tabular-nums; }

.ref-bottom-card { position: sticky; bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 16px); z-index: 900; margin: 12px 20px; padding: 10px 12px; border-radius: 16px; border: 1.5px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.06); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); display: flex; flex-direction: column; gap: 8px; }
.ref-bottom-text { text-align: center; font-weight: 700; }
.ref-share-btn { background: rgba(0,123,255,0.95); color: #fff; border: none; border-radius: 12px; padding: 10px 14px; font-weight: 700; }

/* Bottom personal card over nav bar */
.lb-bottom-card {
    position: sticky;
    bottom: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom) + 16px);
    z-index: 900;
    margin: 12px 20px;              /* как у .leaderboard-section padding по бокам */
    padding: 10px 12px;
    border-radius: 16px;
    border: 1.5px solid rgba(255,255,255,0.3);
    background: rgba(255,255,255,0.06);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    display: grid;
    grid-template-columns: 1fr 0.7fr 0.7fr 0.5fr;
    grid-auto-rows: auto;
    gap: 10px;                      /* как у lb-item */
    align-items: center;
}
/* Бейджи без отдельного стекла (плашка уже со стеклом) */
.lb-bottom-card .lb-badge { background: transparent; border: none; padding: 0; font-size: 13px; font-weight: 700; }
/* Расположение значений под нужными колонками */
#lb-bottom-nick   { grid-column: 1; justify-self: start; }
#lb-bottom-tokens { grid-column: 2; justify-self: end; color: #4caf50; }
#lb-bottom-profit { grid-column: 3; justify-self: end; color: #4caf50; }
#lb-bottom-place  { grid-column: 4; justify-self: end; }

/* Кнопка «Поделиться» — отдельной строкой, во всю ширину */
#lb-bottom-share {
    grid-column: 1 / -1;   /* во всю ширину */
    width: 100%;
    text-align: center;
    background: rgba(0,123,255,0.95);
    color: #fff;
    border: none;
    border-radius: 12px;
    padding: 10px 14px;
    font-weight: 700;
}

/* Делаем место внизу списка, чтобы 10-й игрок был виден под карточкой */
.leaderboard-content .lb-list { padding-bottom: 0; }

/* Wallet (withdraw) view */
.wallet-section { display: flex; flex-direction: column; gap: 16px; padding: 0 0 8px 0; }
.wallet-card {
    border-radius: 20px;
    padding: 18px;
    color: #fff;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1.5px solid rgba(255,255,255,0.2);
}
.wallet-ton { background: linear-gradient(135deg, rgba(0, 123, 255, 0.55), rgba(0, 86, 179, 0.55)); }
.wallet-stars { background: linear-gradient(135deg, rgba(255, 193, 7, 0.55), rgba(255, 152, 0, 0.55)); }
.wallet-card-head { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
.wallet-token-icon { width: 20px; height: 20px; object-fit: contain; }
.wallet-token-name { font-weight: 800; opacity: 0.95; }
.wallet-balance { font-size: 24px; font-weight: 800; text-align: center; margin: 8px 0 12px 0; }
.wallet-actions { display: flex; gap: 10px; justify-content: center; }
.wallet-btn {
    padding: 10px 16px;
    border-radius: 14px;
    border: 1.5px solid rgba(255,255,255,0.25);
    background: rgba(255,255,255,0.18);
    color: #fff; font-weight: 700;
    backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
}
.wallet-btn:hover { transform: translateY(-1px); background: rgba(255,255,255,0.24); }
.wallet-btn:active { transform: translateY(0); }

.wallet-history { border-radius: 20px; border: 1.5px solid rgba(255,255,255,0.2); padding: 14px 16px; background: rgba(255,255,255,0.06); }
.wallet-history-title { font-size: 24px; font-weight: 800; margin-bottom: 10px; }
.wallet-history-list { min-height: 48px; border-radius: 12px; border: none; background: transparent; padding: 0; display: flex; flex-direction: column; gap: 10px; }
.wallet-media-row { display: grid; grid-template-columns: 0.9fr 0.9fr; gap: 10px; justify-content: center; }
.wallet-lottie { width: 90%; aspect-ratio: 1/1; margin: 0 auto; border-radius: 12px; overflow: hidden; }
.wallet-empty-hint { text-align: center; margin-top: 4px; font-weight: 700; opacity: 0.95; }

/* Help Modal Styles */
.help-content {
    max-height: 85vh;
}

.help-header {
    padding: 0 24px 24px;
    text-align: center;
}

.help-title {
    font-size: 24px;
    font-weight: 800;
    color: white;
    margin: 0;
}

.help-content-wrapper {
    padding: 0 24px 32px;
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 24px;
    align-items: center;
}

.help-image-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 280px;
    height: 280px;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.05);
    padding: 20px;
    gap: 16px;
}

.help-image {
    width: 220px;
    height: 220px;
    object-fit: contain;
    border-radius: 12px;
    background: transparent;
    padding: 0;
}

.help-lottie {
    width: 100px;
    height: 100px;
    border-radius: 12px;
    background: transparent;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.help-text-container {
    text-align: center;
}

.help-text {
    font-size: 16px;
    line-height: 1.6;
    color: rgba(255, 255, 255, 0.9);
    margin: 0;
    font-weight: 500;
}

.help-navigation {
    display: flex;
    gap: 12px;
    padding: 0 24px 24px;
}

.help-nav-btn {
    flex: 1;
    padding: 16px;
    border: none;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.help-back-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.8);
}

.help-back-btn:hover,
.help-back-btn:active {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.4);
    color: white;
}

.help-next-btn {
    background: rgba(0, 123, 255, 0.8);
    border: 1px solid rgba(0, 123, 255, 0.3);
    color: white;
}

.help-next-btn:hover,
.help-next-btn:active {
    background: rgba(0, 123, 255, 1);
    border-color: rgba(0, 123, 255, 0.5);
    transform: translateY(-2px);
}

/* Character Edit Modal Styles */
.character-edit-content {
    max-height: 85vh;
    overflow-y: auto;
    background: rgba(14, 15, 18, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.character-edit-content .sheet-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 24px;
}

.character-edit-content .sheet-title {
    margin: 0;
    font-size: 20px;
    font-weight: 700;
}

.reset-btn {
    background: rgba(255, 59, 48, 0.2);
    border: 1px solid rgba(255, 59, 48, 0.4);
    color: #ff3b30;
    padding: 8px 16px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
    /* Обеспечиваем, что кнопка не закрывает модал */
    z-index: 10;
}

.reset-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.5s ease;
}

.reset-btn:hover::before {
    left: 100%;
}

.reset-btn:hover,
.reset-btn:active {
    background: rgba(255, 59, 48, 0.3);
    border-color: rgba(255, 59, 48, 0.6);
    transform: scale(0.98) translateZ(0);
}

.reset-btn:hover {
    background: rgba(255, 59, 48, 0.4);
    box-shadow: 0 4px 15px rgba(255, 59, 48, 0.3);
    transform: scale(0.98) translateZ(0);
}

.edit-section {
    margin-bottom: 32px;
}

.edit-subtitle {
    font-size: 18px;
    font-weight: 700;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 16px;
    text-align: center;
    position: relative;
    padding-bottom: 8px;
}

.edit-subtitle::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 40px;
    height: 2px;
    background: linear-gradient(90deg, transparent, #00d4ff, transparent);
    border-radius: 1px;
    transition: width 0.3s ease;
}

.edit-subtitle:hover::after {
    width: 60px;
    background: linear-gradient(90deg, transparent, #00e6ff, transparent);
}

.items-carousel {
    display: flex;
    align-items: center;
    position: relative;
    width: 100%;
}

/* Скрываем стрелочки */
.carousel-arrow {
    display: none !important;
}

.carousel-container {
    flex: 1;
    overflow: hidden;
    position: relative;
    /* Add gradient edges to show there's more content */
    mask-image: linear-gradient(to right, transparent 0%, black 5%, black 95%, transparent 100%);
    -webkit-mask-image: linear-gradient(to right, transparent 0%, black 5%, black 95%, transparent 100%);
    /* Smooth scrolling container */
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    /* Ensure proper sizing */
    min-width: 0;
    /* Убираем свечение по бокам карусели полностью */
    background: transparent;
    border-radius: 8px;
    width: 100%;
    /* Добавляем отступы для лучшего отображения градиентов */
    padding: 4px 0;
    /* Ограничиваем overflow для контроля свечения */
    overflow: hidden;
}

.carousel-track {
    display: flex;
    gap: 16px;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    padding: 8px 0;
    /* Prevent text selection during swipe */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    /* Smooth scrolling */
    scroll-behavior: smooth;
    /* Prevent horizontal scrollbar */
    overflow-x: hidden;
    /* Ensure track can expand to show all items */
    width: max-content;
    min-width: 100%;
    /* Добавляем отступы по бокам для лучшего отображения */
    padding-left: 8px;
    padding-right: 8px;
    /* Убираем transition по умолчанию для лучшего контроля */
    transition: none;
}

.edit-item {
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    width: 120px;
    min-width: 120px;
    max-width: 120px;
    flex-shrink: 0;
    position: relative;
    overflow: hidden;
    /* Ensure proper rendering */
    will-change: transform;
    transform: translateZ(0);
    /* Очень мягкое синее свечение по бокам, ограниченное границами карточки */
    box-shadow: 0 0 0 1px rgba(0, 212, 255, 0.05);
    /* Гарантируем, что свечение не выходит за границы */
    isolation: isolate;
}

.edit-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.edit-item:hover::before,
.edit-item:active::before {
    opacity: 1;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.08) 100%);
}

.edit-item:hover {
    transform: translateY(-4px) translateZ(0);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3), 0 0 0 2px rgba(0, 212, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.edit-item.selected {
    border-color: #00d4ff;
    background: rgba(0, 212, 255, 0.1);
    box-shadow: 0 0 12px rgba(0, 212, 255, 0.15), 0 0 0 2px rgba(0, 212, 255, 0.2);
    transform: scale(1.05) translateZ(0);
    animation: selectedPulse 2s ease-in-out infinite;
    position: relative;
    z-index: 1;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.edit-item.selected::after {
    content: '✓';
    position: absolute;
    top: 8px;
    right: 8px;
    background: #00d4ff;
    color: white;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    animation: checkmarkAppear 0.3s ease;
    z-index: 2;
}

.edit-item.selected::before {
    background: linear-gradient(135deg, rgba(0, 212, 255, 0.25) 0%, rgba(0, 212, 255, 0.15) 100%);
    opacity: 1;
    animation: selectedGlow 2s ease-in-out infinite;
}

.edit-item img {
    width: 64px;
    height: 64px;
    object-fit: contain;
    border-radius: 8px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
}

.edit-item:hover img,
.edit-item:active img {
    transform: scale(1.05) translateZ(0);
    filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.4));
}

.edit-item.selected img {
    transform: scale(1.1) translateZ(0);
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3)) drop-shadow(0 0 10px rgba(0, 212, 255, 0.5));
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.item-name {
    font-size: 12px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.8);
    text-align: center;
    line-height: 1.3;
}

.edit-actions {
    padding: 24px 0 16px;
    display: flex;
    justify-content: center;
    margin-top: 20px;
}

.accept-btn {
    background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%);
    border: none;
    color: white;
    padding: 16px 48px;
    border-radius: 16px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 20px rgba(0, 212, 255, 0.3);
    position: relative;
    overflow: hidden;
    font-family: var(--font-family);
}

.accept-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 50%, rgba(255, 255, 255, 0.2) 100%);
    transform: translateX(-100%);
    transition: transform 0.6s ease;
}

.accept-btn:hover::before {
    transform: translateX(100%);
}

.accept-btn:hover,
.accept-btn:active {
    transform: translateY(-2px) translateZ(0);
    box-shadow: 0 6px 25px rgba(0, 212, 255, 0.4);
}

.accept-btn:hover {
    background: linear-gradient(135deg, #00e6ff 0%, #00aadd 100%);
    box-shadow: 0 8px 30px rgba(0, 212, 255, 0.5);
    transform: translateY(-2px) translateZ(0);
}

.accept-btn {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

/* Liquid Glass Effect for Edit Items */
.edit-item {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

/* Mobile Responsiveness */
@media (max-width: 480px) {
    .character-edit-content {
        max-height: 90vh;
        padding: 16px;
    }
    
    .edit-item {
        width: 100px;
        min-width: 100px;
        max-width: 100px;
        padding: 12px;
    }
    
    .edit-item img {
        width: 56px;
        height: 56px;
    }
    
    .accept-btn {
        padding: 14px 40px;
        font-size: 15px;
        width: 100%;
        max-width: 280px;
    }
    
    .reset-btn {
        padding: 6px 12px;
        font-size: 13px;
    }
    
    .carousel-track {
        gap: 12px;
        padding-left: 6px;
        padding-right: 6px;
    }
    
    .carousel-container {
        background: transparent;
        padding: 2px 0;
    }
    
    /* Убираем gap у карусели на мобильных */
    .items-carousel {
        gap: 0;
    }
    
    /* Убираем transition по умолчанию для мобильных */
    .carousel-track {
        transition: none;
    }
    
    /* Уменьшаем отступы для мобильных */
    .edit-actions {
        padding: 20px 0 12px;
        margin-top: 16px;
    }
    
    /* Убеждаемся, что свечение одинаковое на мобильных для всех секций */
    .edit-item {
        box-shadow: 0 0 0 1px rgba(0, 212, 255, 0.04) !important;
    }
    
    .edit-item:hover {
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25), 0 0 0 2px rgba(0, 212, 255, 0.08) !important;
    }
    
    .edit-item.selected {
        box-shadow: 0 0 12px rgba(0, 212, 255, 0.15), 0 0 0 2px rgba(0, 212, 255, 0.18) !important;
    }
    
    /* Убираем свечение по бокам карусели на мобильных */
    .carousel-container {
        background: transparent !important;
    }
}

/* Modal Animation */
.sheet-overlay {
    opacity: 0;
    transition: opacity 0.3s ease;
    backdrop-filter: blur(0px);
    -webkit-backdrop-filter: blur(0px);
}

.sheet-overlay.show {
    opacity: 1;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
}

.sheet-overlay.show {
    opacity: 1;
}

.sheet-content {
    transform: translateY(100%);
    transition: transform 0.3s ease;
}

.sheet-overlay.show .sheet-content {
    transform: translateY(0);
}

/* Checkmark Animation */
@keyframes checkmarkAppear {
    from {
        opacity: 0;
        transform: scale(0.5) rotate(-45deg);
    }
    to {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }
}

/* Selected Item Pulse Animation */
@keyframes selectedPulse {
    0%, 100% {
        box-shadow: 0 0 12px rgba(0, 212, 255, 0.15), 0 0 0 2px rgba(0, 212, 255, 0.2);
    }
    50% {
        box-shadow: 0 0 16px rgba(0, 212, 255, 0.18), 0 0 0 2px rgba(0, 212, 255, 0.22);
    }
}

/* Selected Item Glow Animation */
@keyframes selectedGlow {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.8;
    }
}

/* Loading Screen - ВРЕМЕННО ОТКЛЮЧЕНО */
/*
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #16213e 0%, #0f3460 50%, #16213e 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
}

.loading-screen.hidden {
    opacity: 0;
    visibility: hidden;
}

.loading-content {
    text-align: center;
    color: white;
    max-width: 300px;
    padding: 20px;
}

.loading-logo {
    margin-bottom: 30px;
}

.loading-logo-image {
    width: 120px;
    height: auto;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
}

.loading-text {
    font-size: 18px;
    font-weight: 500;
    margin-bottom: 20px;
    color: rgba(255, 255, 255, 0.9);
}

.progress-bar {
    width: 200px;
    height: 6px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
    overflow: hidden;
    margin: 0 auto 10px;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #1343DE, #4a90e2);
    border-radius: 3px;
    transition: width 0.3s ease;
    width: 0%;
}

.progress-text {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.7);
}
*/

/* App container теперь видимый сразу */
.app-container {
    opacity: 1;
    transition: opacity 0.5s ease-in;
}

/* Убираем специфические стили - свечение по бокам карусели полностью отключено */
